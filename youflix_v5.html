<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YouFlix Player v9 (Ultra Stable)</title>

<style>
    body, html {
        margin:0;
        padding:0;
        width:100%;
        height:100%;
        background:#000;
        overflow:hidden;
        font-family:Arial, sans-serif;
    }

    #loadingScreen {
        position:absolute;
        top:0; left:0;
        width:100%; height:100%;
        background:#000;
        color:white;
        display:flex;
        flex-direction:column;
        justify-content:center;
        align-items:center;
        z-index:9999;
    }

    .spinner {
        width:50px; height:50px;
        border:5px solid #333;
        border-top:5px solid #ff4444;
        border-radius:50%;
        animation:spin 1s linear infinite;
    }
    @keyframes spin { 0%{transform:rotate(0);} 100%{transform:rotate(360deg);} }

    #player {
        width:100%;
        height:100%;
    }

    #infoPanel {
        position:absolute;
        top:30px; left:30px;
        padding:10px 15px;
        background:rgba(0,0,0,0.7);
        border-left:4px solid #ff4444;
        border-radius:8px;
        color:white;
        font-size:16px;
        opacity:0;
        transition:opacity .3s;
        z-index:9000;
    }
</style>
</head>

<body>

<div id="loadingScreen">
    <div class="spinner"></div>
    <div style="margin-top:20px;">Učitavam YouTube player...</div>
</div>

<div id="player"></div>

<div id="infoPanel"></div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
let player;
let isPlaying = false;

/* Najstabilnija verzija – bez thumbnail, bez CC menu, bez auto translate */
function onYouTubeIframeAPIReady() {
    const id = new URLSearchParams(window.location.search).get("videoId");

    player = new YT.Player("player", {
        width:"100%",
        height:"100%",
        videoId:id,
        playerVars:{
            autoplay:1,
            controls:0,
            rel:0,
            modestbranding:1,
            fs:1,
            disablekb:1,
            iv_load_policy:3
        },
        events:{
            onReady:onReady,
            onStateChange:onState
        }
    });
}

function onReady() {
    document.getElementById("loadingScreen").style.display="none";
    showInfo("←→ 60s | ENTER pauza/play | BACK izlaz");
}

function onState(e) {
    if (e.data === YT.PlayerState.PLAYING) isPlaying = true;
    if (e.data === YT.PlayerState.PAUSED)  isPlaying = false;
}

/* INFO PANEL */
function showInfo(msg){
    const panel = document.getElementById("infoPanel");
    panel.textContent = msg;
    panel.style.opacity = 1;
    setTimeout(()=>panel.style.opacity=0,2500);
}

/* DPAD – stabilna logika */
document.addEventListener("keydown", e => {

    switch(e.key){

        case "ArrowLeft":
            player.seekTo(player.getCurrentTime() - 60, true);
            break;

        case "ArrowRight":
            player.seekTo(player.getCurrentTime() + 60, true);
            break;

        case "Enter":
            if (isPlaying) player.pauseVideo();
            else player.playVideo();
            break;

        case "Backspace":
        case "Escape":
            history.back();
            break;
    }
});
</script>

</body>
</html>
